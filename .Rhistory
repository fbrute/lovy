#surfs[i] <- calcTrapezeArea(max(a,c),b,min(a,c),d)
surfs[i] <- round(calcTrapezeArea(a,c,h),0)
#                                         surf <- calcTrapezeArea(a,b,c,d)
#
#                                         if (is.nan(surf))
#                                                 surfs[i] <- a*b
#                                         else
#                                                 surfs[i] <- surf
}
}
}
#temps
matrixadiab <- c(temps,surfs)
dim(matrixadiab) <- c(nrow(data1),2)
matrixadiab
}
calcTriangleArea <- function (a=1,b=1,c=sqrt(2)) {
s <- 1/2 * (a + b + c)
sqrt(s * (s-a) * (s-b) * (s-c))}
calcTrapezeAreaBof <- function (a=4,b=sqrt(5),c=6,d=sqrt(5)) {
(a + c) / (4 * abs(a-c)) * sqrt(( a + b - c + d) * (a - b - c + d) *
(a + b - c - d) * (-a + b + c + d))
}
calcTrapezeArea <- function (b1=4, b2=5, h=2) {
(b1+b2)/2*h
}
calcDistance <- function (x1=0, y1=0, x2=1,y2=1) {
sqrt((x2-x1)^2 + (y2-y1)^2)
}
calcAdiabTemp <- function (T1, P1, P2) {
# Compute Adiabatic Temperature
k = 0.2857
T2 <- (P2 / P1)^k * (T1 + 273.15)
#                T2 <- (P2^k / P1) * (T1 + 273.15)
T2 - 273.15
}
getData <- function(datatype="", input){
# Init string to know if it is valid at the end of the function
QueryString <- ""
#                 if (dbg) browser()
if (datatype == "sounding")
QueryString <- paste(
"select date, time , pressure, height, mixr, temp",
"from sounding1",
"where date between", "'", input$daterange[1], "'" ,
"and" , "'", input$daterange[2], "'" ,
"and time = '12:00:00'",
"and pressure between", input$lowerpressure ,"and", input$higherpressure,
"order by date, pressure desc;"
)
#if (dbg) browser()
if (QueryString != "")
return(getMysqlData(QueryString))
}
getMysqlData <- function(queryString=""){
#   View(queryString)
con = dbConnect(dbDriver("MySQL"), user="dbmeteodb",
password="dbmeteodb",
dbname="dbmeteodb",
host="localhost")
# send the query
#                 if (dbg) browser()
#                 tryCatch(queryResultsData <- dbSendQuery(con, queryString),
#                          finally = dbDisconnect(con))
queryResultsData <- dbSendQuery(con, queryString)
#get the data
data <- fetch(queryResultsData, n=-1)
# freeing resources
dbClearResult(queryResultsData)
dbDisconnect(con)
View(data)
data
}
# TODO
# décalage d'une heure entre pm10_16 et pm10_24, ok entre 1 et 23 pour l'instant
# comment traiter les jours où il y a peu de données aot ? moins de 3 ?
mainPower()
source('~/Documents/Trafin/lovy/regression1.8.R')
source('~/Documents/Trafin/lovy/regression1.8.R');mainreg()
source('~/Documents/Trafin/lovy/regression1.8.R')
source('~/Documents/Trafin/lovy/regression1.8.R');mainreg()
source('~/Documents/Trafin/lovy/regression1.8.R')
library(ggplot2)
source('~/Documents/Trafin/lovy/regression1.8.R')
library(RUnit)
testResult
shiny::runApp('soundingbymonth')
shiny::runApp('~/Documents/Trafin/aptf/aptf2k14.R/apbm')
detach(shiny)
installed.packages(shiny)
installed.packages("shiny")
detach("package:shiny", unload=TRUE)
library("shiny", lib.loc="~/R/x86_64-pc-linux-gnu-library/3.1")
shiny::runApp('~/Documents/Trafin/aptf/aptf2k14.R/apbm')
load("~/Documents/Trafin/lovy/soundingbymonth/df.powers2k12.RData")
load("~/Documents/Trafin/lovy/soundingbymonth/df.powers2k12.RData")
View(df.powers)
write.csv(file = "./power/data/df.powers.2k12.RData")
write.csv(df.powers,file = "./power//data/powers2012.csv")
source('~/Documents/Trafin/lovy/mixr/tests.R')
mixr.test()
source('~/Documents/Trafin/lovy/mixr/tests.R')
mixr.test()
source('~/Documents/Trafin/lovy/mixr/runitmixr.R')
mixr.test()
source('~/Documents/Trafin/lovy/mixr/runitmixr.R')
mixr.test()
source('~/Documents/Trafin/lovy/mixr/tests.R')
mixr.test()
source('~/Documents/Trafin/lovy/mixr/runitmixr.R')
source('~/Documents/Trafin/lovy/mixr/runitmixr.R')
mixr.test()
source('~/Documents/Trafin/lovy/mixr/tests.R')
mixr.test()
mixr.test()
source('~/Documents/Trafin/lovy/mixr/runitmixr.R')
source('~/Documents/Trafin/lovy/mixr/runitmixr.R')
source('~/Documents/Trafin/lovy/mixr/tests.R')
library(testthat)
mixr.test()
source('~/Documents/Trafin/lovy/mixr/runitmixr.R')
mixr.test()
source('~/Documents/Trafin/lovy/mixr/runitmixr.R')
mixr.test()
source('~/Documents/Trafin/lovy/mixr/runitmixr.R')
source('~/Documents/Trafin/lovy/mixr/runitmixr.R')
mixr.test()
source('~/Documents/Trafin/lovy/mixr/runitmixr.R')
source('~/Documents/Trafin/lovy/mixr/tests.mixr.R')
source('~/Documents/Trafin/lovy/mixr/tests.mixr.R')
getwd)
getwd()
source("mixr/mixr.R")
setwd("mixr/")
test_file("tests.mixr.R")
source('~/Documents/Trafin/lovy/mixr/tests.mixr.R')
source('~/Documents/Trafin/lovy/mixr/tests.mixr.R')
source('~/Documents/Trafin/lovy/mixr/tests.mixr.R')
source('~/Documents/Trafin/lovy/mixr/tests.mixr.R')
source('~/Documents/Trafin/lovy/mixr/tests.mixr.R')
source('~/Documents/Trafin/lovy/mixr/tests.mixr.R')
test_file("tests.mixr.R")
test_file("tests.mixr.R")
test_file("tests.mixr.R")
class(1)
test_file("tests.mixr.R")
test_file(file="tests.mixr.R")
test_dir(".")
test_dir()
test_file(file="tests.mixr.R")
test_file("tests.mixr.R")
test_file(path = "tests.mixr.R")
test_file(path = "tests.mixr.R", reporter = "minimal")
test_file(path = "tests.mixr.R")
test_file(path = "tests.mixr.R1")
test_file
testthat::find_reporter("summary")
test_file(path = "tests.mixr.R1")
test_file(path = "tests.mixr.R1", reporter ="summary")
detach("package:testthat", unload=TRUE)
library("testthat", lib.loc="/usr/lib64/R/library")
test_file(path = "tests.mixr.R1", reporter ="summary")
test_file(path = "tests.mixr.R1")
test_file
test_file(path = "tests.mixr.R1")
source("mixr.R")
source("mixr.R")
test_file(path = "tests.mixr.R1")
test_file(path = "tests.mixr.R")
library(testthat)
test_file("./mixr/tests.mixr.R")
source('~/Documents/Trafin/lovy/mixr/tests.R')
mixr.test()
mixr.test()
mixr.test()
mixr.test()
mixr.test()
mixr.test()
mixr.test()
test_file("./mixr/tests.mixr.R")
test_that("test", expect_that(1 > 0 , is_true))
test_that("test", expect_that(1 > 0 , is_true()))
test_that("test", expect_that(1 > 3 , is_true()))
test_that(path = "test", expect_that(1 > 3 , is_true()))
test_file(path="./mixr/tests.mixr.R")
library("testthat", lib.loc="/usr/lib64/R/library")
detach("package:testthat", unload=TRUE)
library("testthat", lib.loc="/usr/lib64/R/library")
test_file
mixr.test()
mixr.test()
mixr.test()
mixr.test()
mixr.test()
mixr.test()
mixr.test()
mixr.test()
mixr.test()
mixr.test()
mixr.test()
mixr.test()
mixr.test()
months("2012-01-01")
months(as.Date("2012-01-01")
)
months.Date("2012-01-01")
a.Date("2012-01-01")
format(as.Date("2012-01-01"),"%m")
format(as.Date("2012-04-01"),"%m")
mixr.test()
mixr.test()
remove.packages(testthat)
remove.packages("testthat")
install.packages("testthat")
library(testthat)
expect_equal(1, is.numeric())
expect_true(is.numeric(1))
expect_true(is.numeric("i"))
test_file("./mixr/tests.mixr.R")
library("testthat", lib.loc="/usr/lib64/R/library")
test_file("./mixr/tests.mixr.R")
install.packages("testthat")
library("testthat", lib.loc="/usr/lib64/R/library")
detach("package:testthat", unload=TRUE)
library("testthat", lib.loc="/home//fbrute/R/x86_64-pc-linux-gnu-library//3.1/testthat//libs")
library("testthat", lib.loc="/home//fbrute/R/x86_64-pc-linux-gnu-library//3.1")
test_file("./mixr/tests.mixr.R")
remove.packages("testthat", lib="/usr/lib64/R/library")
remove.packages("testthat", lib="/usr/lib64/R/library")
library("testthat", lib.loc="/usr/lib64/R/library")
remove.packages("testthat")
remove.packages("testthat", lib="/usr/lib64/R/library")
library("testthat", lib.loc="/home//fbrute/R/x86_64-pc-linux-gnu-library//3.1")
test_file("./mixr/tests.mixr.R")
test_file("./mixr/tests.mixr.R")
test_file("./mixr/tests.mixr.R444")
test_file("./mixr/tests.mixr.R")
mixr.test()
mixr.test()
con = dbConnect(dbDriver("MySQL"), user="dbmeteodb",
password="dbmeteodb",
dbname="dbmeteodbtest",
host="localhost")
mixr.test()
test_package("/home//fbrute/R/x86_64-pc-linux-gnu-library//3.1/testthat")
test_package("/home//fbrute/R/x86_64-pc-linux-gnu-library//3.1/testthat/R/testthat)
)
)
""
''
"
test_package("/home//fbrute/R/x86_64-pc-linux-gnu-library//3.1/testthat/R/testthat")
detach("package:RUnit", unload=TRUE)
test_file("./mixr/tests.mixr.R")
test_file()
test_file
dbg(test_file)
test_file)
test_file())
test_file()
detach("package:testthat", unload=TRUE)
library("testthat", lib.loc="~/R/x86_64-pc-linux-gnu-library/3.1")
test_file()
install.packages("devtools")
library("devtools", lib.loc="~/R/x86_64-pc-linux-gnu-library/3.1")
devtools::use_testthat
devtools::use_testthat()
install.packages(c("devtools", "roxygen2", "testthat", "knitr"))
detach("package:devtools", unload=TRUE)
install.packages(c("devtools", "roxygen2", "testthat", "knitr"))
install.packages("roxygen2")
devtools::install_github("hadley/devtools")
library(devtools)
has_devel)
has_devel()
has_devel()
devtools::create("~/Documents/Trafin/fouyol/recherche/aerosol")
dir.create("~/Documents/Trafin/fouyol/recherche/aerosol")
devtools::create("~/Documents/Trafin/fouyol/recherche/aerosol")
devtools::create("~/Documents/Trafin/fouyol/recherche/dvpt/aerosol")
shiny::runApp('soundingbymonth')
shiny::runApp('soundingbymonth')
shiny::runApp('soundingbyday')
install.packages("shiny")
install.packages("shiny")
install.packages("shiny")
shiny::runApp('soundingbyday')
library(devtools)
devtools::test("shiny")
devtools::test(shiny)
library(testthat)
testthat::test_check(shiny)
testthat::test_check("shiny")
testthat::test_package(shiny)
testthat::test_package("shiny")
shiny::runApp('soundingbymonth')
shiny::runApp('soundingbymonth')
source('~/Documents/Trafin/lovy/power/regressions/regression1.8.R')
mainreg()
mainreg()
mainreg()
mainreg()
mainreg()
paste("~/Documents/Trafin/lovy/df.powers2k",
substr(input$year,3,4),
".RData",sep="")
source('~/Documents/Trafin/lovy/power/regressions/regression1.8.R')
mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.8.R')
source('~/Documents/Trafin/lovy/power/regressions/regression1.8.R')
mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.8.R')
mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.8.R')
mainreg()
mainreg()
mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.8.R')
mainreg()
mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.8.R')
mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.8.R')
mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.8.R')
source('~/Documents/Trafin/lovy/power/regressions/regression1.8.R')
mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.8.R')
mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.8.R')
mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.8.R')
mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.8.R')
mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.8.R')
source('~/Documents/Trafin/lovy/power/regressions/regression1.8.R')
mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.8.R')
mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.8.R')
mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.8.R')
mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.8.R')
mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.8.R')
mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.8.R')
mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.8.R')
mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.8.R')
mainreg()
cork
source('~/Documents/Trafin/lovy/power/regressions/regression1.8.R')
mainreg()
View(df.cors)
View(df.cor)
source('~/Documents/Trafin/lovy/power/regressions/regression1.8.R')
mainreg()
mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.8.R')
source('~/Documents/Trafin/lovy/power/regressions/regression1.8.R')
mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.8.R')
mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.8.R')
mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.8.R')
mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.8.R')
mainreg()
qt(0.95, df = 25)
qt(0.975, df = 25)
2869/3008
(2869/3008)^2
View(df)
as.character(2007:2012)
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R')
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R')
mainreg()
getMysqlData
mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
rm(getData)
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
rm(getCon)
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
rm(getMysqlData)
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
source('~/Documents/Trafin/lovy/power/power.R')
source('~/Documents/Trafin/lovy/power/power.R')
source('~/Documents/Trafin/lovy/power/power.R');mainpower()
load("~/Documents/Trafin/fouyol/recherche/dvpt/aerosol/data/df.power.rda")
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R')
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
View(df.power)
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
View(df.power)
View(df.power)
View(df.power)
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
View(df.power)
View(df.power)
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
View(df.power)
quantile(df.power, probs = (0.05, 0.95))
quantile(df.power$power, probs = (0.05, 0.95))
quantile(df.power$power, probs = c(0.05, 0.95))
quantile(df.power$power, probs = c(0.05, 0.95))[1]
quantile(df.power$power, probs = c(0.05, 0.95))[2]
df.power2 <- df.power
View(df.power)
subset(df.power, power < 914.4 & power > 427.3)
quantile(df.power$pm10, probs = c(0.05, 0.95))[2]
quantile(df.power$pm10, probs = c(0.05, 0.95))
quantile(df.power$power, probs = c(0.05, 0.95))
subset(df.power, power < 914.4 & power > 427.3 & pm10 > 12.8 & pm10 < 60.7458)
quantile(df.power$pm10, probs = c(0.05))
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
source('~/Documents/Trafin/lovy/power/regressions/regression1.10.R'); mainreg()
append(1:13,17)
shiny::runApp('soundingbymonth')
shiny::runApp('soundingbymonth')
shiny::runApp('soundingbymonth')
shiny::runApp('soundingbymonth')
View(df.power)
lmpower <- lm(pm10 ~ power, data = df.power)
summary(lmpower)
df.jul2k12 <- subset(df.power, date > as.Date("30-06-2012", and date < as.Date("01-08-2012")))
df.jul2k12 <- subset(df.power, date > as.Date("30-06-2012") & date < as.Date("01-08-2012"))
View(df.power)
df.jul2k12 <- subset(df.power, date > as.Date("2012-06-30") & date < as.Date("2012-08-01"))
lmpower.jul2k12 <- lm(pm10 ~ power, data = df.jul2k12)
summary(lmpower.jul2k12)
df.may_aug2k12 <- subset(df.power, date > as.Date("2012-04-30") & date < as.Date("2012-09-01"))
lmpower.may_aug2k12 <- lm(pm10 ~ power, data = df.may_aug2k12)
summary(lmpower.may_aug2k12)
plot(df.may_aug2k12$pm10 ~ df.may_aug2k12$power)
abline(lmpower.may_aug2k12)
24*60
14/2
View(df.power)
lmpower.may_aug2k12 <- lm(pm10 ~ power + mixr, data = df.may_aug2k12)
lmpower.may_aug2k12 <- lm(pm10 ~ power + meanmixr, data = df.may_aug2k12)
summary(lmpower.may_aug2k12)
lmpower.may_aug2k12 <- lm(pm10 ~ meanmixr, data = df.may_aug2k12)
summary(lmpower.may_aug2k12)
anova(lmpower.may_aug2k12)
lmpower.may_aug2k12 <- lm(pm10 ~ power + meanmixr, data = df.may_aug2k12)
anova(lmpower.may_aug2k12)
View(df.power)
hist(df.power)
hist(df.power$pm10)
barplot(df.power$pm10)
barplot(df.power$pm10 ~ df.power$year)
g <- ggplot(data = df.power)
library(ggplot2)
g <- ggplot(data = df.power)
g + geom_bar(aes(x = month, y = pm10, fill = year), stat="identity", position = "dodge")
g + geom_bar(aes(x = month, y = pm10, fill = year))
g + geom_bar(aes(x = month, y = pm10, fill = year), stat="identity", position = "dodge")
g + geom_bar(aes(x = year, y = pm10, fill = month), stat="identity", position = "dodge")
g + geom_bar(aes(x = year, y = pm10), stat="identity", position = "dodge")
g + geom_bar(aes(x = year, y = pm10, fill = month), stat="identity", position = "dodge")
choose(10,2)
0.915^2
sqrt(100 * 0.11 * (1-0.11))
sqrt(100 * 0.11 * (1-0.11))*2
sqrt(100 * 0.11 * (1-0.11))
0.12^4
1-0.12^4
qnorm(0.975)
qnorm(0.99)
195528-1627
276*(17.8-10.4)^2 + 468 * (13.6-7.4)^2 + 87 *(15.6-8.3)^2
(17.8-10.4)^2 + (13.6-7.4)^2 +(15.6-8.3)^2
10.4+7.4+8.3
26.1/3
(17.8-8.7)^2 + (13.6-8.7)^2 +(15.6-8.7)^2
276*(17.8-8.7)^2 + 468*(13.6-8.7)^2 +87*(15.6-8.7)^2
1627/2
193901/828
813.5/234.18
